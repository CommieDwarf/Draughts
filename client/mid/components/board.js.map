{"version":3,"file":"board.js","sourceRoot":"","sources":["../../src/components/board.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nimport TopLabel from './/labels/top-label';\r\nimport LeftLabel from './labels/left-label';\r\nimport Chessboard from './board/chessboard';\r\nimport RightLabel from './labels/right-label';\r\nimport BotLabel from './labels/bot-label';\r\nimport ContextMenu from \"./board/context-menu\";\r\nimport WinMenu from \"./board/winMenu\";\r\n\r\nimport Game from \"../game\";\r\nimport { Color } from './board/getPieceJSX';\r\n\r\ntype MyState = {\r\n    contextMenu: {\r\n        piece: string,\r\n        queen: boolean,\r\n        i: number,\r\n        clientX : number,\r\n        clientY: number,\r\n        showMenu: boolean\r\n    },\r\n    winner: \"\" | Color\r\n}\r\ntype MyProps = {\r\n    \r\n}\r\n\r\nexport default class Board extends React.Component<MyProps, MyState> {\r\n    \r\n\r\n    props: {\r\n        game: Game;\r\n        restartGame: () => void;\r\n    }\r\n\r\n    interval: ReturnType<typeof setTimeout> | null;\r\n    contextMenuRef: React.RefObject<HTMLDivElement>\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.props = props;\r\n        this.state = { \r\n            contextMenu: {\r\n                piece: \"\",\r\n                queen : false, \r\n                i : 0,\r\n                clientX : 0, \r\n                clientY : 0,\r\n                showMenu : false,\r\n            },\r\n            winner: \"\",\r\n        };\r\n        this.contextMenuRef = React.createRef();\r\n        this.interval = null;\r\n    }\r\n\r\n    setWinner = (winner: Color) => {\r\n        this.setState({\r\n            winner: winner\r\n        })\r\n    }\r\n\r\n    clickHandler = (event: any) => {\r\n        //this.setState({contextMenu: {...this.state.contextMenu, showMenu: false}});\r\n        this.props.game.clickHandler(event);\r\n    }\r\n\r\n    hideContextMenu = () => {\r\n        this.setState((prevState) => {\r\n            return {\r\n                contextMenu: {...prevState.contextMenu, showMenu: false}\r\n            }\r\n        })\r\n    }\r\n\r\n    onContextHandler = (event: any) => {\r\n        event.preventDefault();\r\n        let engine = this.props.game.engine;\r\n\r\n        let square = event.target.closest(\".chessboard__square\");\r\n        if (square && square.className !== \"chessboard__square chessboard__square--white\") {\r\n            let id = square.getAttribute(\"id\");\r\n            const queen = engine.chessboard[id][\"queen\"]\r\n            const piece = engine.chessboard[id][\"piece\"]\r\n            let clientRect = square.getBoundingClientRect();\r\n            let clientX = clientRect.left;\r\n            let clientY = clientRect.top;\r\n            const width = square.offsetWidth;\r\n            const height = square.offsetHeight;\r\n            clientX += width / 2;\r\n            clientY += height / 2 + 10;\r\n\r\n            this.setState({contextMenu: {\r\n                piece: piece,\r\n                queen : queen, \r\n                i : id,\r\n                clientX : clientX, \r\n                clientY : clientY,\r\n                showMenu : true,\r\n            }})\r\n        }\r\n        \r\n        return false;\r\n    }\r\n\r\n   \r\n\r\n\r\n\r\n    render() {\r\n        if (restartFlag) {\r\n            restartFlag = false;\r\n        }\r\n        let engine = this.props.game.engine;\r\n\r\n\r\n        return (\r\n            <div className=\"board\"  onClick={this.clickHandler} onContextMenu={this.onContextHandler}>\r\n                {this.props.game.engine.winner && <WinMenu winner={engine.winner} restart={this.props.restartGame}/>}\r\n                <TopLabel/>\r\n                <LeftLabel/>\r\n                <RightLabel/>\r\n                <Chessboard engine = {engine} preview = {false} id={0} game={this.props.game} setWinner={this.setWinner}/>\r\n                <BotLabel/>\r\n                {this.state.contextMenu.showMenu && <ContextMenu contextMenu={this.state.contextMenu} chessboard={engine.chessboard} hide={this.hideContextMenu}/>}\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n}\r\n\r\nlet restartFlag = false;\r\n\r\n"]}