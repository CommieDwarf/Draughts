{"version":3,"file":"context-menu.js","sourceRoot":"","sources":["../../../src/components/board/context-menu.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { IChessboard } from \"../../engine\";\r\n\r\n\r\nexport default class ContextMenu extends React.Component {\r\n\r\n    ctxMenuRef: React.RefObject<HTMLDivElement>\r\n    props: {\r\n        contextMenu: {\r\n            piece: string,\r\n            queen: boolean,\r\n            i: number,\r\n            clientX: number,\r\n            clientY: number,\r\n            showMenu: boolean,\r\n        }\r\n        hide: () => void;\r\n        chessboard: IChessboard;\r\n    }\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.props = props;\r\n        this.state = {}\r\n        this.ctxMenuRef = React.createRef();\r\n    }\r\n\r\n    onClickTopHandler = () => {\r\n        let props = this.props\r\n        if (props.contextMenu.queen) {\r\n            props.chessboard[props.contextMenu.i][\"queen\"] = false;\r\n        } else if (props.contextMenu.piece) {\r\n            props.chessboard[props.contextMenu.i]['queen'] = true;\r\n        } else {\r\n            props.chessboard[props.contextMenu.i][\"piece\"] = \"black\";\r\n        }\r\n        document.dispatchEvent(new Event(\"chessboardChanged\"));\r\n    }\r\n\r\n    onClickBotHandler = () => {\r\n        let props = this.props\r\n        if (props.contextMenu.queen) {\r\n            props.chessboard[props.contextMenu.i][\"piece\"] = \"\";\r\n            props.chessboard[props.contextMenu.i][\"queen\"] = false;\r\n        } else if (props.contextMenu.piece) {\r\n            props.chessboard[props.contextMenu.i]['piece'] = \"\";\r\n        } else {\r\n            props.chessboard[props.contextMenu.i][\"piece\"] = \"white\";\r\n        }\r\n        document.dispatchEvent(new Event(\"chessboardChanged\"));\r\n    }\r\n    \r\n    \r\n\r\n    setCordAttributes() {\r\n        let contextMenu = this.ctxMenuRef.current;\r\n        \r\n        if (contextMenu) {\r\n            let attribute = \"left: \" + this.props.contextMenu.clientX + \"px; \";\r\n            attribute += \"top: \" + this.props.contextMenu.clientY + \"px; \";\r\n            contextMenu.setAttribute(\"style\", attribute);\r\n        }\r\n        \r\n    }\r\n    \r\n    handleOutsideClick = (event: MouseEvent) => {\r\n        let target = event.target as HTMLElement;\r\n        if (target && this.ctxMenuRef.current && !target.contains(this.ctxMenuRef.current)) {\r\n            this.props.hide();\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setCordAttributes() \r\n        let container = document.querySelector(\".container\") as HTMLElement;\r\n        if (container) {\r\n            container.addEventListener(\"click\", this.handleOutsideClick)\r\n        }\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.setCordAttributes() \r\n        let container = document.querySelector(\".container\") as HTMLElement;\r\n        if (container) {\r\n            container.removeEventListener(\"click\", this.handleOutsideClick)\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let props = this.props;\r\n\r\n        let label1\r\n        let label2\r\n\r\n        if (props.contextMenu.queen) {\r\n            label1 = \"queen\";\r\n            label2 = \"remove\";\r\n        } else if (props.contextMenu.piece) {\r\n            label1 = \"queen\";\r\n            label2 = \"remove\";\r\n        } else {\r\n            label1 = \"black\";\r\n            label2 = \"white\";\r\n        }\r\n\r\n  \r\n\r\n        return (\r\n            <div className={\"context-menu\"} ref={this.ctxMenuRef}>\r\n                <div className=\"context-menu__label\" onClick={this.onClickTopHandler}>\r\n                    {label1}\r\n                </div>\r\n                <hr className=\"context-menu__break-line\"/>\r\n                <div className=\"context-menu__label\" onClick={this.onClickBotHandler}>\r\n                    {label2}\r\n                </div>\r\n                <br></br>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}"]}